<%= render partial: "shared/header", locals: {title: "Maps" , back: root_path,single_page: ""} %>


<div class="d-flex content-justify-between row mx-1">
    <div>
      <p><%= @maps.first.time %></p>
    </div>
    <div>
        <a href="<%= maps_path + "/current"%>" class="btn btn-sm btn-outline-primary">Go to Live Map</a>
    </div>

</div>


<div id="map" class="map my-4">
  <!-- OL map will be here  -->
</div>

<nav aria-label="Page navigation example">
  <ul class="pagination">
  <%= will_paginate @maps, renderer: @bootstrap_paginate_renderer %>
  </ul>
</nav>

<script type="text/javascript">

	// adding GPS DATA
	window.geojsonObject =  {
	  'type': 'FeatureCollection',
	  'crs': {
	    'type': 'name',
	    'properties': {
	      'name': 'EPSG:3857'
	    }
	  },
	  'features': [
		<% if(Map.any?) then %>
		{
	    'type': 'Feature',
	    'geometry': {
	      'type': 'Point',
	      'coordinates': ol.proj.fromLonLat([
        <%= @maps.first.lon %>
        ,
        <%= @maps.first.lat %>
        ])
	    }
	  },
		<% end %>
		{
	    'type': 'Feature',
	    'geometry': {
	      'type': 'LineString',
	      'coordinates': [
				<% @maps.each do |map| %>
					ol.proj.fromLonLat([
			        <%= map.lon %>
			        ,
			        <%= map.lat %>
					]),
					<% end %>
			]
	    }
	  }


		]
	};
  </script>
